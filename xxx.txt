
async def main():
    await client.start()
    print("Client created successfully.")
    # دریافت اطلاعات کانال با استفاده از یوزرنیم
    try:
        entity = await client.get_entity(channel_username)
    except errors.UsernameNotOccupiedError:
        print("The provided username is not associated with any account.")
        return

    while True:
        try:
            links = read_links()
            for link in links:
                new_content = fetch_content(link)
                if new_content is not None:
                    old_content = old_links_content.get(link)
                    if old_content is None or old_content != new_content:
                        await send_content_to_telegram(entity, new_content)
                        old_links_content[link] = new_content
                        save_content(link, new_content)
        except Exception as e:
            print(f"An error occurred: {e}")
        await asyncio.sleep(60)
